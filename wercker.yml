
box: docker:latest

build:
  docker: true
  steps:
    - script:
        code: |
          apk add --update --no-cache nodejs nodejs-npm
          echo $(node -p "require('./package.json').version")
          echo $DOCKERHUB_PASSWORD | docker login --username="$DOCKERHUB_USERNAME" --password-stdin
          docker build --tag="$DOCKERHUB_USERNAME/$(node -p "require('./package.json').docker.name"):$(node -p "require('./package.json').docker.tag")" .
          docker push $DOCKERHUB_USERNAME/$(node -p "require('./package.json').docker.name"):$(node -p "require('./package.json').docker.tag")
          
